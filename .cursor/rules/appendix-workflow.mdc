---
description:
globs:
alwaysApply: false
---
# Appendix & Supplementary Materials Workflow

This rule captures **how and when** to prepare the appendix PDF and the `artefacts.zip` submitted at the NeurIPS *technical appendices and supplementary material* deadline (May\,22\,2025\,AoE, see CFP).

---

## When does this rule apply?
* Any time work is scoped for the *supplementary upload* rather than the nine-page main paper.
* Whenever the branch name matches `supplementary/*` or a commit message references *appendix*, *supplementary*, or *artefacts.zip*.
* Before pushing to CI on the default branch **if** the appendix or artefacts structure changed.

## Folder Layout
```text
supplementary/
  appendix.tex          # standalone appendix (NeurIPS style, no page limit)
  build/                # latexmk and intermediate files (git-ignored)
  figures/              # large images regenerated by tests (git-ignored)
  levi_civita.pt        # model weights (download script or Git-LFS pointer)
  scripts/
    verify_model.py     # smoke-test model loads and differentiates
```

## Build & Validate
1. **Assemble** everything via the Justfile target:
   ```bash
   just build-supp
   ```
   which internally performs:
   * `latexmk -pdf appendix.tex` (output → `appendix.pdf`)
   * `python -m pytest -m reproduces_figures` to regenerate plots
   * `python scripts/verify_model.py` to load `levi_civita.pt` and run a smoke test
2. **Pack** the artefacts:
   ```bash
   zip -r artefacts.zip supplementary/
   ```
3. **Size check** (< 100 MB):
   ```bash
   du -sh artefacts.zip
   ```
4. **CI guard**: GitHub Action asserts the artefact builds and is under the size limit on every push to `supplementary/*`.

## Version Control Strategy
* Keep large binaries (e.g. videos, `.pt` files) out of git—use Git LFS or download scripts.
* Commit deterministic build scripts & small text assets.
* Tag a release `supp-YYYYMMDD` once artefact is frozen.

## CHANGELOG & Documentation
* Add a bullet in `CHANGELOG.md` whenever the artefact structure changes.
* Reference this rule in commit messages: `refs appendix-workflow-rule`.

## Rationale
* Separating supplementary content lets us ship a minimum-viable nine-page paper early while still providing full reproducibility by the later deadline.
* A reproducible, CI-tested artefact zip de-risks last-minute failures.

---

_Last reviewed: 2025-05-16_
